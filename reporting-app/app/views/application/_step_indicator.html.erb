<%
# Reusable USWDS Step Indicator Component
# Usage:
# <%= render "application/step_indicator", 
#      steps: ["Step 1", "Step 2", "Step 3"],
#      current_step: 2,
#      options: { center: false, no_labels: false, counters: false }
# %>
<%
steps ||= []
current_step ||= 1
options ||= {}

css_classes = ["usa-step-indicator"]
css_classes << "usa-step-indicator--center" if options[:center]
css_classes << "usa-step-indicator--no-labels" if options[:no_labels]
css_classes << "usa-step-indicator--counters" if options[:counters]
css_classes << "usa-step-indicator--counters-sm" if options[:counters_sm]
-%>

<div class="<%= css_classes.join(' ') %>">
  <ol class="usa-step-indicator__segments">
    <% steps.each_with_index do |step_label, index| %>
      <% 
        step_number = index + 1
        is_complete = step_number < current_step
        is_current = step_number == current_step
        
        segment_classes = ["usa-step-indicator__segment"]
        segment_classes << "usa-step-indicator__segment--complete" if is_complete
        segment_classes << "usa-step-indicator__segment--current" if is_current
      %>
      
      <li class="<%= segment_classes.join(' ') %>" <%= 'aria-current="true"'.html_safe if is_current %>>
        <span class="usa-step-indicator__segment-label">
          <%= step_label %>
          <% if is_complete %>
            <span class="usa-sr-only">completed</span>
          <% elsif !is_current %>
            <span class="usa-sr-only">not completed</span>
          <% end %>
        </span>
      </li>
    <% end %>
  </ol>
  
  <div class="usa-step-indicator__header">
    <h4 class="usa-step-indicator__heading">
      <span class="usa-step-indicator__heading-counter">
        <span class="usa-sr-only">Step</span>
        <span class="usa-step-indicator__current-step"><%= current_step %></span>
        <span class="usa-step-indicator__total-steps">of <%= steps.length %></span>
      </span>
      <span class="usa-step-indicator__heading-text"><%= steps[current_step - 1] %></span>
    </h4>
  </div>
</div>

