<h1>Report your community engagement (IVaaS)</h1>
<p class="usa-intro">
  Certify your community engagement requirements using the Centers for Medicare and Medicaid Service's income reporting app.
</p>
<section class="d-flex flex-column flex-md-row gap-4 align-items-start justify-content-between">
  <table class="usa-table usa-table--borderless width-full">
    <thead>
      <tr>
        <th scope="col">
          Case number
        </th>
        <th scope="col">
          Actions
        </th>
      </tr>
    </thead>
    <tbody>
      <% for activity_report in @in_progress_activity_reports do %>
        <tr>
          <td>
            <%= activity_report.id %>
          </td>
          <td>
            <%= link_to "Certify",
                        edit_activity_report_application_form_path(
                          activity_report,
                          reporting_source: "income_verification_service"
                        ),
                        class: "usa-button" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</section>
<%# render template: "flex/application_forms/index", locals: {
  title: t(".activity_report.title"),
  intro: t(".activity_report.intro"),
  new_button_text: t(".activity_report.new_button"),
  new_path: new_activity_report_application_form_path,
  in_progress_applications_heading: t(".activity_report.in_progress_applications.heading"),
  application_forms: @activity_report_application_forms.map { |form| {
    created_at: form.created_at.strftime("%B %d, %Y at %I:%M %p"),
    path: activity_report_application_form_path(form),
    status: form.status
  }}
} %>
<h1><%= t(".title") %></h1>
<% if @activity_report_application_form.nil? && @exemption_application_form.nil? %>
  <%= render "new_certification" %>
<% elsif @activity_report_application_form&.in_progress? %>
  <%= render "activity_report_in_progress", activity_report: @activity_report_application_form %>
<% elsif @activity_report_application_form&.submitted? && @activity_report_case&.activity_report_approval_status.nil? %>
  <%= render "activity_report_submitted", activity_report: @activity_report_application_form %>
<% elsif @activity_report_application_form&.submitted? && @activity_report_case&.activity_report_approval_status == "approved" %>
  <%= render "activity_report_approved", certification: @certification %>
<% end %>
